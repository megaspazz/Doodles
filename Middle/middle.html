<html>
	<head>
		<title>Middle</title>
	</head>
	<body>
		<h1>M I [D] D L E</h1>
		<div>
			<p>
				Form as many words as you can by using some letters from the left half, the middle letter, and some letters from the right half.
			</p>
			<p>
				Refresh the page to get a new puzzle.
			</p>
		</div>
		<svg id="svgGame"></svg>
		<div>
			<label for="txtInput">Guess a word</label>
			<input id="txtInput" type="text" onkeydown="processInput();" autofocus></input>
		</div>
		<div id="divWords"></div>
		
		<script src="words.js"></script>
		<script src="game.js"></script>
		<script src="render.js"></script>
		<script src="solution.js"></script>
		<script src="letter_circle.js"></script>
		<script src="word_circle.js"></script>
		<script type="text/javascript">
			const DEBUG = false;
			
			function log() {
				if (DEBUG) {
					console.log(...arguments);
				}
			}
			
			const PREFIX_LENGTH = 5;
			const SUFFIX_LENGTH = 5;
			
			const WIDTH = 800;
			const HEIGHT = 600;
			const RADIUS = 160;
			const FONT_SIZE = 24;
			const FONT_FAMILY = "Helvetica, sans-serif";
			const LETTER_RADIUS = 32;
			const MIDDLE_BORDER_SIZE = 8;
			
			function createSVGElement(tag, attrs, text) {
				let elt = document.createElementNS(SVG_NS, tag);
				for (const [name, value] of Object.entries(attrs)) {
					elt.setAttribute(name, value);
				}
				if (text) {
					elt.textContent = text;
				}
				return elt;
			}
			
			function style(styles) {
				return Object.entries(styles).map(([name, value]) => {
					return name + ": " + value + ";";
				}).join(" ");
			}
			
			const SVG_NS = "http://www.w3.org/2000/svg";
			
			function newGame(prefixLength, suffixLength) {
				let svgGame = document.getElementById("svgGame");
				svgGame.setAttribute("width", WIDTH);
				svgGame.setAttribute("height", HEIGHT);
				
				log(game);
				render.updateGame(game);
				
				let txtInput = document.getElementById("txtInput");
				txtInput.onkeydown = processInput;
			}
			
			let render;
			let game;
			
			//let game = new Game("HELL", "O", "RLDW");
			
			window.onload = function() {
				let svgGame = document.getElementById("svgGame");
				svgGame.setAttribute("width", WIDTH);
				svgGame.setAttribute("height", HEIGHT);

				game = Game.generate(PREFIX_LENGTH, SUFFIX_LENGTH);
				log(game);

				render = new Render(document.getElementById("svgGame"));
				render.updateGame(game);
				
				let txtInput = document.getElementById("txtInput");
				txtInput.onkeydown = processInput;
			}
			
			function processInput(e) {
				if (e.key == "Enter") {
					let txtInput = document.getElementById("txtInput");
					let word = txtInput.value.toUpperCase();
					if (game.checkAndUpdate(word)) {
						render.updateGame(game);
						log("BIG winner: " + word);
					} else {
						log("BIG loser: " + word);
					}
					txtInput.value = "";
				}
			}
		</script>
	</body>
</html>
